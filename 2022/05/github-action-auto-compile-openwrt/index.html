<!doctype html><html lang=zh-hans><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-33RTKT44MP"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-33RTKT44MP",{anonymize_ip:!1})}</script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="利用 Github Action 自动编译OpenWrt"><meta itemprop=description content="想自己用 Linux 编译 请看这个视频 https://www.bilibili.com/video/BV1854y1W7fu/ 本次教程基于下列前车之鉴 https://github.com/KFERMercer/OpenWrt-CI 注册 Github 本步骤跳过，网上一大堆，请参考。 1. Fork Openwrt 打开 https://github.com/immortalwrt/immortalwrt/fork 2. 修改 ▶️Actions 的 Workflows yml文"><meta itemprop=datePublished content="2022-05-17T15:21:34+08:00"><meta itemprop=dateModified content="2022-05-17T15:21:34+08:00"><meta itemprop=wordCount content="925"><meta itemprop=keywords content="openwrt,Github,"><meta property="og:title" content="利用 Github Action 自动编译OpenWrt"><meta property="og:description" content="想自己用 Linux 编译 请看这个视频 https://www.bilibili.com/video/BV1854y1W7fu/ 本次教程基于下列前车之鉴 https://github.com/KFERMercer/OpenWrt-CI 注册 Github 本步骤跳过，网上一大堆，请参考。 1. Fork Openwrt 打开 https://github.com/immortalwrt/immortalwrt/fork 2. 修改 ▶️Actions 的 Workflows yml文"><meta property="og:type" content="article"><meta property="og:url" content="https://vicfree.com/2022/05/github-action-auto-compile-openwrt/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-17T15:21:34+08:00"><meta property="article:modified_time" content="2022-05-17T15:21:34+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="利用 Github Action 自动编译OpenWrt"><meta name=twitter:description content="想自己用 Linux 编译 请看这个视频 https://www.bilibili.com/video/BV1854y1W7fu/ 本次教程基于下列前车之鉴 https://github.com/KFERMercer/OpenWrt-CI 注册 Github 本步骤跳过，网上一大堆，请参考。 1. Fork Openwrt 打开 https://github.com/immortalwrt/immortalwrt/fork 2. 修改 ▶️Actions 的 Workflows yml文"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><title>利用 Github Action 自动编译OpenWrt</title><link rel=stylesheet href=https://vicfree.com/css/style.min.eac77496566fd7d5768fd650ddb0b2b181ca6a2d7c5fdd6fe6b8ba4bf47e566f.css integrity="sha256-6sd0llZv19V2j9ZQ3bCysYHKai18X91v5ri6S/R+Vm8=" crossorigin=anonymous></head><body id=page><header id=site-header class="animated slideInUp"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://vicfree.com>Victor</a></div><nav class="site-nav hide-in-mobile"><a href=https://vicfree.com/posts/>Blog</a>
<a href=https://vicfree.com/tags/>Tags</a>
<a href=https://vicfree.com/about/>About</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-social hide-in-mobile"><a href=https://twitter.com/realDonaldTrump target=_blank rel="noopener me" title=Twitter><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a href=https://t.me/JhKgAA6Hx1 target=_blank rel="noopener me" title=Telegram><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.198 2.433a2.242 2.242.0 00-1.022.215l-8.609 3.33c-2.068.8-4.133 1.598-5.724 2.21a405.15 405.15.0 01-2.849 1.09c-.42.147-.99.332-1.473.901-.728.968.193 1.798.919 2.286 1.61.516 3.275 1.009 4.654 1.472.509 1.793.997 3.592 1.48 5.388.16.36.506.494.864.498l-.002.018s.281.028.555-.038a2.1 2.1.0 00.933-.517c.345-.324 1.28-1.244 1.811-1.764l3.999 2.952.032.018s.442.311 1.09.355c.324.022.75-.04 1.116-.308.37-.27.613-.702.728-1.196.342-1.492 2.61-12.285 2.997-14.072l-.01.042c.27-1.006.17-1.928-.455-2.474a1.654 1.654.0 00-1.034-.407z"/></svg></a><a href=http://www.vicfree.com/qqgroup target=_blank rel="noopener me" title=Qq><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path transform="scale(0.04) translate(75 40)" stroke-width="50" d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741.0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792.0.0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"/></svg></a><a href=https://github.com/openwrt/openwrt target=_blank rel="noopener me" title=Github><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://vicfree.com/posts/>Blog</a></li><li><a href=https://vicfree.com/tags/>Tags</a></li><li><a href=https://vicfree.com/about/>About</a></li></ul></div><main class="site-main section-inner animated fadeIn faster"><article class=thin><header class=post-header><div class=post-meta><span>May 17, 2022</span></div><h1>利用 Github Action 自动编译OpenWrt</h1></header><div class=content><blockquote><p>想自己用 Linux 编译 请看这个视频 <a href=https://www.bilibili.com/video/BV1854y1W7fu/>https://www.bilibili.com/video/BV1854y1W7fu/</a></p></blockquote><h3 id=本次教程基于下列前车之鉴>本次教程基于下列前车之鉴<a href=#本次教程基于下列前车之鉴 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p><a href=https://github.com/KFERMercer/OpenWrt-CI>https://github.com/KFERMercer/OpenWrt-CI</a></p><h2 id=注册-github>注册 Github<a href=#注册-github class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>本步骤跳过，网上一大堆，请参考。</p><h2 id=1-fork-openwrt>1. Fork Openwrt<a href=#1-fork-openwrt class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>打开 <a href=https://github.com/immortalwrt/immortalwrt/fork>https://github.com/immortalwrt/immortalwrt/fork</a></p><h2 id=2-修改-actions-的-workflows-yml文件>2. 修改 ▶️Actions 的 Workflows yml文件<a href=#2-修改-actions-的-workflows-yml文件 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><ol><li><p>进入你 <code>Fork</code> 后的 <code>OpenWrt</code> 页面</p></li><li><p>检查当前的 <code>OpenWrt</code> 有没有 <code>.github/workflows</code> 文件夹</p><blockquote><p>有 -> 进入<code>.github/workflows</code> 修改里面的 <code>***.yml</code> 文件</p></blockquote><blockquote><p>没有 -> 进入 <code>▶️Actions</code> 会自动新建 <code>.github/workflows\main.yml</code></p></blockquote></li><li><p>复制我在下文提供的 yml模板，粘贴。</p></li><li><p>（可选）参考下文进行自定义修改，比如 <code>加软件</code> <code>改平台</code></p></li><li><p>修改两处 branch 名，从模板的 <code>openwrt-21.02</code> 修改为你当前正在编辑 branch，比如 <code>master</code> 或 <code>main</code></p></li><li><p>修改完成后 <code>Start commit</code> -> <code>Commit changes</code></p></li></ol><h2 id=3-此时你的-openwrt-会自动开始编译>3. 此时你的 OpenWrt 会自动开始编译<a href=#3-此时你的-openwrt-会自动开始编译 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><p>时长约两小时，完成后，去<code>▶️Actions</code>页面下载 <code>OpenWrt_firmware</code> 即可</p><h2 id=4-自定义固件>4. 自定义固件<a href=#4-自定义固件 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><ol><li>找到你需要安装的包名，官方软件包大全 <a href=https://openwrt.org/packages/index/start>https://openwrt.org/packages/index/start</a></li><li>软件包可以从编译环境下 <code>make defconfig</code> 生成 <code>.config</code> 中找到</li></ol><blockquote><p>比如 # CONFIG_PACKAGE_luci-app-dockerman is not set</p></blockquote><ol start=3><li>添加包名到<code>openwrt-ci.yml</code> 中 <code>cat >> .config &lt;&lt;EOF</code>后面，对着我的例子进行修改。</li></ol><blockquote><p>修改为 CONFIG_PACKAGE_luci-app-dockerman=y</p></blockquote><ol start=4><li>编译其他固件，需要修改 <code>Target</code>-> <code>子Target</code> -> <code>设备名</code> 修改下面三行做例子。</li></ol><blockquote><p>注意要和其他行 <code>首字母对齐</code>，错位必编译错误！</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=w>          </span><span class=l>CONFIG_TARGET_ramips=y</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=l>CONFIG_TARGET_ramips_mt7621=y</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=l>CONFIG_TARGET_ramips_mt7621_DEVICE_youhua_wr1200js=y</span><span class=w>
</span></span></span></code></pre></div><h2 id=5-我目前使用的模板>5. 我目前使用的模板<a href=#5-我目前使用的模板 class=anchor aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h2><blockquote><p>我x86默认编译vmdk给ESXi，你用不到可以删除此行。</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># This is free software, lisence use MIT.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Copyright (C) 2019 P3TERX &lt;https://p3terx.com&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Copyright (C) 2020 KFERMercer &lt;KFER.Mercer@gmail.com&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># &lt;https://github.com/KFERMercer/OpenWrt-CI&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OpenWrt-CI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>openwrt-21.02</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># schedule:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#   - cron: 0 20 * * *</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>workflow_dispatch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>release</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>types</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>published]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build_openwrt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Build OpenWrt firmware</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-22.04</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>github.event.repository.owner.id == github.event.sender.id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Checkout</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>openwrt-21.02</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Space cleanup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>DEBIAN_FRONTEND</span><span class=p>:</span><span class=w> </span><span class=l>noninteractive</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          docker rmi `docker images -q`
</span></span></span><span class=line><span class=cl><span class=sd>          sudo rm -rf /usr/share/dotnet /etc/mysql /etc/php /etc/apt/sources.list.d /usr/local/lib/android
</span></span></span><span class=line><span class=cl><span class=sd>          sudo -E apt-get -y purge azure-cli ghc* zulu* hhvm llvm* firefox google* dotnet* powershell openjdk* adoptopenjdk* mysql* php* mongodb* dotnet* moby* snapd* || true
</span></span></span><span class=line><span class=cl><span class=sd>          sudo -E apt-get update
</span></span></span><span class=line><span class=cl><span class=sd>          sudo -E apt-get -y install build-essential clang flex g++ gawk gcc-multilib gettext git libncurses5-dev libssl-dev python3-distutils rsync unzip zlib1g-dev file wget asciidoc binutils bzip2 util-linux help2man intltool libelf-dev make patch perl-modules python3-dev xsltproc qemu-utils
</span></span></span><span class=line><span class=cl><span class=sd>          sudo -E apt-get -y autoremove --purge
</span></span></span><span class=line><span class=cl><span class=sd>          sudo -E apt-get clean
</span></span></span><span class=line><span class=cl><span class=sd>          df -h</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Update feeds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          # sed -i &#39;s/#src-git helloworld/src-git helloworld/g&#39; ./feeds.conf.default
</span></span></span><span class=line><span class=cl><span class=sd>          # echo &#34;src-git helloworld https://github.com/fw876/helloworld.git&#34; &gt;&gt; &#34;feeds.conf.default&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          ./scripts/feeds update -a
</span></span></span><span class=line><span class=cl><span class=sd>          ./scripts/feeds install -a</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Generate configuration file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          rm -f ./.config*
</span></span></span><span class=line><span class=cl><span class=sd>          touch ./.config
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          #
</span></span></span><span class=line><span class=cl><span class=sd>          # 在 cat &gt;&gt; .config &lt;&lt;EOF 到 EOF 之间粘贴你的编译配置, 需注意缩进关系
</span></span></span><span class=line><span class=cl><span class=sd>          # 例如:
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          cat &gt;&gt; .config &lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_TARGET_x86=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_TARGET_x86_64=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_TARGET_x86_64_DEVICE_generic=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_VMDK_IMAGES=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_LUCI_LANG_en=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_LUCI_LANG_zh_Hans=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_zabbix-extra-network=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-attendedsysupgrade=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-ddns=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-firewall=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-https-dns-proxy=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-nlbwmon=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-sqm=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-ssr-plus=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-ssr-plus_INCLUDE_Hysteria=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-ssr-plus_INCLUDE_Trojan=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-turboacc=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_TURBOACC_INCLUDE_BBR_CCA=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-upnp=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-vlmcsd=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-wireguard=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-app-wol=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_avahi-dbus-daemon=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_avahi-utils=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_bind-dig=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_ddns-scripts-cloudflare=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_ddns-scripts-dnspod=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_ddns-scripts_aliyun=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_nmap-ssl=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_adguardhome=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_curl=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_nano=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_open-vm-tools=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_qrencode=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_whois=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_luci-proto-ipv6=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_wget-ssl=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_libip6tc=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_ip6tables=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_ip6tables-mod-nat=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_kmod-ipt-nat6=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_kmod-nf-nat6=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_odhcpd-ipv6only=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_odhcp6c=y
</span></span></span><span class=line><span class=cl><span class=sd>          CONFIG_PACKAGE_6in4=y
</span></span></span><span class=line><span class=cl><span class=sd>          EOF
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          #
</span></span></span><span class=line><span class=cl><span class=sd>          # ===============================================================
</span></span></span><span class=line><span class=cl><span class=sd>          # 
</span></span></span><span class=line><span class=cl><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          sed -i &#39;s/^[ \t]*//g&#39; ./.config
</span></span></span><span class=line><span class=cl><span class=sd>          make defconfig</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Make download</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          make download -j8 || make download -j1 V=s
</span></span></span><span class=line><span class=cl><span class=sd>          rm -rf $(find ./dl/ -size -1024c)
</span></span></span><span class=line><span class=cl><span class=sd>          df -h</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Compile firmware</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          make -j$(nproc) || make -j1 V=s
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;=======================&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;Space usage:&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;=======================&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          df -h
</span></span></span><span class=line><span class=cl><span class=sd>          echo &#34;=======================&#34;
</span></span></span><span class=line><span class=cl><span class=sd>          du -h ./ --max-depth=1
</span></span></span><span class=line><span class=cl><span class=sd>          du -h /mnt/openwrt/ --max-depth=1 || true</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Prepare artifact</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          mkdir -p ./artifact/firmware
</span></span></span><span class=line><span class=cl><span class=sd>          mkdir -p ./artifact/package
</span></span></span><span class=line><span class=cl><span class=sd>          mkdir -p ./artifact/buildinfo
</span></span></span><span class=line><span class=cl><span class=sd>          rm -rf $(find ./bin/targets/ -type d -name &#34;packages&#34;)
</span></span></span><span class=line><span class=cl><span class=sd>          cp -rf $(find ./bin/targets/ -type f) ./artifact/firmware/
</span></span></span><span class=line><span class=cl><span class=sd>          cp -rf $(find ./bin/packages/ -type f -name &#34;*.ipk&#34;) ./artifact/package/
</span></span></span><span class=line><span class=cl><span class=sd>          cp -rf $(find ./bin/targets/ -type f -name &#34;*.buildinfo&#34; -o -name &#34;*.manifest&#34;) ./artifact/buildinfo/</span><span class=w>          
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deliver buildinfo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/upload-artifact@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OpenWrt_buildinfo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./artifact/buildinfo/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deliver package</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/upload-artifact@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OpenWrt_package</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./artifact/package/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deliver firmware</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/upload-artifact@v3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OpenWrt_firmware</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./bin/targets/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Upload release asset</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>github.event == &#39;release&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>svenstaro/upload-release-action@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>repo_token</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.YOURTOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>file</span><span class=p>:</span><span class=w> </span><span class=l>./artifact/firmware/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class=l>${{ github.ref }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>file_glob</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></div></div><hr class=post-end><footer class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://vicfree.com/tags/openwrt>openwrt</a></span><span class=tag><a href=https://vicfree.com/tags/github>Github</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>925 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2022-05-17 07:21 +0000</p></footer></article><div class="post-nav thin"><a class=next-post href=https://vicfree.com/2022/07/traefik-cert-export/><span class=post-nav-label><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>&nbsp;Newer</span><br><span>traefik acme 证书导出</span></a>
<a class=prev-post href=https://vicfree.com/2022/04/install-sonarr-radarr-jackett-with-docker-compose/><span class=post-nav-label>Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span><br><span>一键安装 Sonarr Radarr Jackett 追剧一条龙</span></a></div><div id=comments class=thin><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//vicfree.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2024 <a href=https://vicfree.com>Victor</a> &#183; <a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></p><p>Made with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> &#183; Theme <a href=https://github.com/Track3/hermit target=_blank rel=noopener>Hermit</a> &#183; <a href=https://vicfree.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></p></footer><script src=https://vicfree.com/js/bundle.min.580988ed2982bcbb74a1773c7abea97b43e4c43b9324e10cda0813ec6ec4bb67.js integrity="sha256-WAmI7SmCvLt0oXc8er6pe0PkxDuTJOEM2ggT7G7Eu2c=" crossorigin=anonymous></script></body></html>